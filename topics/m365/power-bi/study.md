# 실습 가이드

해당 순서로 실습을 진행할 예정입니다.\
해당 내용은 제공하지 않으며 교육자만 소지합니다.

실습예제 파일은 topics의 실습자료에 업로드할 예정입니다.

## 1. 데이터 가공

쿼리는 데이터를 불러오고 가공하는 하나의 데이터 처리 단위

### 데이터 정리 (머리글, 불필요한 행 및 열 제거)

1. 데이터 쿼리 가져오기 (sales 2017)
2. 홈 탭에서 불필요한 상위 행 제거
3. 홈 탭에서 첫 행을 머리글로 사용
4. 보기 탭 열 품질
5. 홈 탭에서 빈행 제거
6. 비어있는 열의 필터에서 비어있음, NA 체크 풀기
7. 유니크 열 클릭 후 중복된 행 제거
8. 보기 탭의 열선택에서 불필요한 열 제거

### 열 타입 변경

1. 매출액 타입
2. 전체 열 선택 후 데이터 형식 검색 후 오류 찾기 (price, delivery_date_format2)
3. 다시 원래대로 변경 후 delivery_date_format2의 경우 로캘 사용 -> 데이터 형식을 날짜로 바꾸로 로캘은 영어(영국)선택
4. price 쿼리의 경우 NA 체크 풀기
5. 다시 변환 탭의 데이터 형식 검색
6. revenue, price 쿼리 고정 10진수 형식으로 변경

### 데이터 값 나누고 여백 정리

1. pormo_bin_1 홈 탭의 값 바꾸기로 찾을 값: verylow -> 바꿀 항목: very low
2. sales를 숫자 형식으로 변경하기 위해, 홈 탭의 값 바꾸기로 찾을 값: sales -> 바꿀 값은 공백으로 하여 뒤에 붙은 sales를 없애고 정수로 형식 변경
3. store_cities 데이터 가져오고 stores로 이름 변경
4. store size의 숫자를 뽑아오기 위해 변환 탭의 추출 -> 구분 기호 앞 텍스트에 공백 한 칸 입력
5. state - state abr - city를 분리하기 위해 변환 탭의 열 분할 -> 구분 기호 기준
6. 위도 경도도 19번과 같은 작업
7. 나눈 부분 열(city)의 헤드 우클릭 -> 변환 -> 공백제거
8. producthierarchy 쿼리 데이터 가져오고 product로 이름 변경
9. 홈탭의 첫 행을 머리글로 사용
10. product 쿼리의 product 열 헤드 좌클릭 -> 변환 -> 정리로 여백 제거
11. length x depth x width 부분, category || sub_category 부분 열 분할

### 쿼리 추가하기 (위, 아래로 확장)

1. 홈 탭의 새 원본으로 sales 2018, 2019 가져오기
2. 홈 탭의 첫 행을 머리글로 사용
3. 홈 탭의 "쿼리 추가"는 선택된 쿼리에 다른 쿼리를 추가하는 것이고, "쿼리를 새항목으로 추가"는 새로운 쿼리를 만드는 것 임을 설명. 새항목으로 추가된 쿼리는 Power Query 프로젝트 내부에서만 존재
4. 홈 탭의 쿼리를 새항목으로 추가
5. 첫 번째 테이블을 2018, 두 번째 테이블을 2019로 설정 후 확인 (열 이름이 같은지 확인 필수)
6. 만들어진 추가1 쿼리의 이름을 sales로 변경
7. 홈 탭의 변환 탭의 데이터 형식 검색
8. 데이터가 변경되지 않은 price에서 NA 필터로 제거하고 고정 10진수 타입으로 변경, revenue도 고정 10진수 타입 변경 (문제 있을 시 필터에서 빈 값 제외)
9. sales 정수로 타입 변경, 문제 있을 시, 빈 값 필터에서 제외하기
10. sales 2017의 order_id (unique)를 sales의 order_id와 동일하게 변경
11. 홈 탭의 쿼리 추가를 통해 sales 쿼리를 sales 2017 쿼리와 병합, 3개 이상의 테이블 -> sales 2017 추가 후 확인

### 쿼리 병합하기 (옆으로 확장)

1. 홈 탭의 새 원본으로 store costs 가져오기
2. 홈 탭의 첫 행을 머리글로 사용
3. 변환 탭의 데이터 형식 검색
4. stores 테이블의 홈탭의 쿼리 병합 클릭
5. stores - construction costs를 클릭한 후 위 아래 테이블 모두 store_id 클릭
6. 왼쪽 외부 조인 확인 후 병합
7. 오른쪽 끝에 추가된 stores - construction costs 헤드 클릭 후 "원래 열 ~ 접두사로 사용" 체크를 풀고 확인
8. store_id.1 열 제거

### 피벗 (한 행에 서로 다른 cost열이 3개가 있어 합계를 구하기 어려움)

1. stores 의 building-consts, land and development costs, other related cost 를 모두 선택 후 변환 탭의 열 피벗 해제

### 그룹 생성

1. 쿼리 에디터 좌측 쿼리 패널 우클릭 후 새 그룹 -> 이름을 Helper Tables 로 하여 생성
2. sales 2017, 2018, 2019, Stores - construction costs를 Helper Tables 그룹으로 이동

## 2. 모델, 테이블 관리

### 데이터 패털에서 테이블 숨기기

1. 메인 화면 우측 데이터 패널에서 sales 2017, 2018, 2019, Stores - construction costs을 우클릭 후 숨기기
2. 숨겨진 항목 표시, 모두 숨기기 취소를 통해 숨겨진 테이블 확인 가능

### 카테고리 별 매출 그래프 (모델 연결이 안되어 있을 시 어떻게 되는지 확인이 목적)

1. 홈탭 의 삽입 -> 누적세로막대형 차트를 편집기 데이터 창에 불러오기
2. 데이터 패널에서 prduct 테이블의 category를 x축으로 불러오기
3. 데이터 패널에서 sales 테이블의 revenue를 y축으로 불러오기 (빌드)
4. 좌특 "모델보기" 패널에서 데이터 모델
5. 공통된 열 찾기
6. sales의 poduct id 와 porduct의 product id 연결

### state 별 매출 그래프 (모델 연결이 안되어 있을 시 어떻게 되는지 확인이 목적)

1. store의 state를 누적세로막대형으로 생성
2. sales의 revenue를 y축에 추가
3. sales의 store id와 stores의 store id 연결

### 모델 관계 와 필터 방향 설명

1. 설명은 너무 깊지 않게 하기
2. 설명 후 테이블 두 개 만들기
3. 첫 테이블은 city와 revenue
4. 두 번째 테이블은 store_id와 store size (필터 방향 때문에 적합하지 않음을 증명)

## 3. 그래프

### 빌드 패널의 요약 선택해보기 (도시 간 가격 수준의 차이)

1. store의 city 를 누적세로막대형으로 생성
2. sales의 price를 y축으로 설정
3. 빌드 패널 y축의 데이터 옵션 -> price 합계를 평균으로 수정
4. 그래프 삭제

#### 빌드 패널의 범례 추가해보기 (각 카테고리별 프로모션 매출 비중)

1. Category 별 매출 합계 그래프의 빌드에서 범례에 프로모션 타입 추가

#### 빌드 패널의 축소 다중 항목 (도시별로 나눠 보기)

1. 축소 다중 항목에 city 입력

### 막대 그래프에 데이터 레이블 적용

1. 서식 패널 -> 데이터 레이블 -> 바깥쪽 끝(옵션), 투명도 조절(배경)

#### 원형 차트로 주 별 매출 비율 만들기

1. state와 revenue를 통해 원형차트 생성
2. 서식 패널의 범례 제거
3. 서식 패널의 세부 정보 레이블에서 범주와 총 퍼센트 선택 (원형 차트는 비율이 효과적)
4. 빌드 패널의 자세히(데이터를 한 단계 더 세분화해서 보여주는 필드 영역)에 city 추가해 보면서 설명해주기 -> 다시 제거
5. 차트의 더보기(...)의 축정렬로 정렬도 바꿔보기

#### 드릴 탐색으로 계층 구조 바꿔보기

1. X축 order_date, Y축 revenue로 꺽인 선형 차트 생성
2. 드릴 탐색 설명해주기
3. Category 별 매출 합계 그래프의 X축에 subcategory 추가
4. 드릴 탐색 설명해주기 (확장 다운시 서브카테고리들이 카테고리끼리 붙어 있음)

#### Y축과 보조 Y축 차이, 선형 차트는 계열 레이블

1. X축 order_date, Y축 revenue로 꺽인 선형 차트의 Y축에 sales 추가 해보기
2. 해당 sales를 보조 Y축에 옮겨 보기
3. 서식 패널의 계열 레이블 켜기

### 확대/축소 슬라이더

1. 선형 차트의 서식 패널에 확대/축소 슬라이더 켜기
2. X축으로 드릴 다운 가능한거 보여주기

### 기본 필터와 테이블 차트(날짜별 매출과 주문 건수)

1. 테이블의 열에 order_date를 추가
2. 빌드 패널에 order_date 화살표 -> 날짜를 계층에서 order_date로 변경
3. 데이터 패널에서 order_date를 클릭하고 열 도구 탭에서 서식을 short로 변경
4. 매출과 order ID를 열에 추가 하고 이름 변경(Order Date, Revenue, Orders)
5. 빌드 패널의 Orders의 화살표 클릭 -> 요약을 개수(고유)로 변경
6. 빌드 패널의 Revenue의 요약을 요약 안함으로 바꿈
7. Revenue가 0인 Orders를 확인 후 필터 패널의 Revenue 클릭
8. 기본 필터링에서 모두 선택 후 0은 체크 지우기
9. 빌드 패널에서 Revenue의 요약을 합계로 변경

### Top 3 필터

1. 원형 차트 선택 후 필터 패널 선택
2. 필터 패널에서 state 클릭 후 필터 형식 선택, 상위 N 필터 선택
3. 값에 sales의 revenue 추가 후 필터 적용

### 트리맵 차트 사용해보기

1. 카테고리 별 sales 막대형 차트를 Treemap으로 변경
2. 범주의 sub_category를 자세히로 이동

### 슬라이서 사용해 보기

1. 슬라이서 생성하여 stores의 store_id 추가
2. 서식 패널에서 슬라이서 설정 -> 스타일에서 드롭다운 변경 -> 선택에서 다중선택, 모두 선택 켜기
3. 빌드 패널 빌드에서 값 이름 매장으로 변경
4. 슬라이서 추가 옵션(...) 누른 후 검색을 눌러 검색 가능하도록 변경
5. Cost(초기 투자 비용) 로 사이 슬라이서도 추가해보기
6. 슬라이서 동기화 패널 추가하고 슬라이서 선택
7. 슬라이서 동기화 패널에서 표시 설정

### 상호 작용 편집 설명하기

1. 원형차트 선택 후 리본메뉴 서식 탭에서 상호 작용 편집을 클릭하여 상호 작용 편집 상태로 진입
2. 막대 그래프의 필터/강조표시/없음을 눌러서 어떤식으로 변화 하는지 보여주기

### 드릴 스루

1. 두 번째 페이지에 텍스트 상자 추가
2. 텍스트 상자 서식 지정에 제목 켜기
3. 텍스트의 조건부 서식 클릭
4. 옵션 선택을 product의 category 클릭
5. 두 번째 페이지(Details)의 빈 캔버스를 선택 후 서식 패널 클릭
6. 페이지 정보의 페이지 유형을 드릴스루로 변경
7. 데이터 추가에 revenue 추가
8. 첫 페이지에 revenue가 포함된 차트에서 특정 값을 우클릭
9. 드릴 스루 클릭 Details 클릭
10. 아래 Detail 페이지 우클릭 후 숨기기

## 4. 배포
